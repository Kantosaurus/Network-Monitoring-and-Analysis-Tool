import React, { useState, useEffect } from 'react';
import {
  IconRadar,
  IconBoxMultiple,
  IconShieldLock,
  IconBug,
  IconFlame,
  IconKey,
  IconRocket,
  IconFileDescription,
  IconX,
  IconPlayerPlay,
  IconPlayerStop,
  IconAlertTriangle,
  IconCpu,
  IconSearch
} from '@tabler/icons-react';
import {
  PortScanResult,
  HostDiscoveryResult,
  PacketCraftTemplate,
  MITMSession,
  VulnerabilityScanResult,
  SessionToken,
  ExploitPayload,
  AttackReport
} from '@/types';

interface PentestingPanelProps {
  onClose: () => void;
}

type TabType = 'recon' | 'packet-craft' | 'mitm' | 'vuln-scan' | 'dos' | 'session' | 'exploit' | 'reports';

const PentestingPanel: React.FC<PentestingPanelProps> = ({ onClose }) => {
  const [activeTab, setActiveTab] = useState<TabType>('recon');

  // Reconnaissance state
  const [reconTarget, setReconTarget] = useState('');
  const [reconPorts, setReconPorts] = useState('1-1000');
  const [scanType, setScanType] = useState<'syn' | 'connect' | 'udp' | 'stealth'>('syn');
  const [portScanResults, setPortScanResults] = useState<PortScanResult[]>([]);
  const [hostDiscoverySubnet, setHostDiscoverySubnet] = useState('192.168.1.0/24');
  const [discoveryMethod, setDiscoveryMethod] = useState<'ping' | 'arp' | 'tcp' | 'full'>('arp');
  const [discoveredHosts, setDiscoveredHosts] = useState<HostDiscoveryResult[]>([]);
  const [scanning, setScanning] = useState(false);

  // Packet Crafting state
  const [craftProtocol, setCraftProtocol] = useState<'TCP' | 'UDP' | 'ICMP' | 'ARP' | 'DNS' | 'HTTP'>('TCP');
  const [craftFields, setCraftFields] = useState<Record<string, any>>({
    srcIP: '192.168.1.100',
    dstIP: '192.168.1.1',
    srcPort: 12345,
    dstPort: 80
  });
  const [craftedPacket, setCraftedPacket] = useState('');
  const [packetCount, setPacketCount] = useState(1);
  const [packetDelay, setPacketDelay] = useState(100);

  // MITM state
  const [mitmType, setMitmType] = useState<'arp-spoof' | 'dns-spoof' | 'ssl-strip'>('arp-spoof');
  const [mitmTarget, setMitmTarget] = useState('');
  const [mitmGateway, setMitmGateway] = useState('');
  const [mitmSessions, setMitmSessions] = useState<MITMSession[]>([]);

  // Vulnerability Scanning state
  const [vulnTarget, setVulnTarget] = useState('');
  const [vulnScanType, setVulnScanType] = useState<'quick' | 'full' | 'web' | 'ssl'>('quick');
  const [vulnerabilities, setVulnerabilities] = useState<VulnerabilityScanResult[]>([]);
  const [vulnScanning, setVulnScanning] = useState(false);

  // DoS Attack state
  const [dosTarget, setDosTarget] = useState('');
  const [dosPort, setDosPort] = useState(80);
  const [dosType, setDosType] = useState<'syn' | 'udp' | 'icmp' | 'slowloris'>('syn');
  const [dosDuration, setDosDuration] = useState(10);
  const [dosActive, setDosActive] = useState(false);

  // Session Hijacking state
  const [sessionTokens, setSessionTokens] = useState<SessionToken[]>([]);
  const [selectedToken, setSelectedToken] = useState<SessionToken | null>(null);
  const [newTokenValue, setNewTokenValue] = useState('');

  // Exploit Delivery state
  const [exploitCategory, setExploitCategory] = useState<'shellcode' | 'reverse-shell' | 'bind-shell' | 'web-shell' | 'injection'>('reverse-shell');
  const [exploitPayloads, setExploitPayloads] = useState<ExploitPayload[]>([]);
  const [selectedPayload, setSelectedPayload] = useState<ExploitPayload | null>(null);
  const [exploitTarget, setExploitTarget] = useState('');
  const [exploitPort, setExploitPort] = useState(4444);
  const [deliveryMethod, setDeliveryMethod] = useState<'tcp' | 'udp' | 'http'>('tcp');

  // Reports state
  const [reports, setReports] = useState<AttackReport[]>([]);

  // Load MITM sessions on mount
  useEffect(() => {
    const loadMITMSessions = async () => {
      if (!window.api) return;
      const result = await window.api.getMITMSessions();
      if (result.success && result.sessions) {
        setMitmSessions(result.sessions);
      }
    };
    loadMITMSessions();
  }, []);

  // Load session tokens on mount
  useEffect(() => {
    const loadTokens = async () => {
      if (!window.api) return;
      const result = await window.api.extractSessionTokens();
      if (result.success && result.tokens) {
        setSessionTokens(result.tokens);
      }
    };
    loadTokens();
  }, []);

  const handlePortScan = async () => {
    if (!window.api || !reconTarget) return;
    setScanning(true);
    const result = await window.api.portScan(reconTarget, reconPorts, scanType);
    setScanning(false);
    if (result.success && result.results) {
      setPortScanResults(result.results);
    } else {
      alert(`Port scan failed: ${result.error}`);
    }
  };

  const handleHostDiscovery = async () => {
    if (!window.api || !hostDiscoverySubnet) return;
    setScanning(true);
    const result = await window.api.hostDiscovery(hostDiscoverySubnet, discoveryMethod);
    setScanning(false);
    if (result.success && result.hosts) {
      setDiscoveredHosts(result.hosts);
    } else {
      alert(`Host discovery failed: ${result.error}`);
    }
  };

  const handleCraftPacket = async () => {
    if (!window.api) return;
    const template: PacketCraftTemplate = {
      id: Date.now().toString(),
      name: `${craftProtocol} Packet`,
      description: 'Custom crafted packet',
      protocol: craftProtocol,
      fields: craftFields
    };
    const result = await window.api.craftPacket(template);
    if (result.success && result.packetData) {
      setCraftedPacket(result.packetData);
    } else {
      alert(`Packet crafting failed: ${result.error}`);
    }
  };

  const handleSendCraftedPacket = async () => {
    if (!window.api || !craftedPacket) return;
    const result = await window.api.sendCraftedPacket(craftedPacket, packetCount, packetDelay);
    if (result.success) {
      alert(`Successfully sent ${result.sent} packets`);
    } else {
      alert(`Failed to send packets: ${result.error}`);
    }
  };

  const handleStartMITM = async () => {
    if (!window.api || !mitmTarget || !mitmGateway) return;
    const result = await window.api.startMITM(mitmType, mitmTarget, mitmGateway);
    if (result.success) {
      alert(`MITM attack started (Session: ${result.sessionId})`);
      // Refresh sessions
      const sessionsResult = await window.api.getMITMSessions();
      if (sessionsResult.success && sessionsResult.sessions) {
        setMitmSessions(sessionsResult.sessions);
      }
    } else {
      alert(`Failed to start MITM: ${result.error}`);
    }
  };

  const handleStopMITM = async (sessionId: string) => {
    if (!window.api) return;
    const result = await window.api.stopMITM(sessionId);
    if (result.success) {
      alert('MITM attack stopped');
      // Refresh sessions
      const sessionsResult = await window.api.getMITMSessions();
      if (sessionsResult.success && sessionsResult.sessions) {
        setMitmSessions(sessionsResult.sessions);
      }
    } else {
      alert(`Failed to stop MITM: ${result.error}`);
    }
  };

  const handleVulnerabilityScan = async () => {
    if (!window.api || !vulnTarget) return;
    setVulnScanning(true);
    const result = await window.api.vulnerabilityScan(vulnTarget, vulnScanType);
    setVulnScanning(false);
    if (result.success && result.vulnerabilities) {
      setVulnerabilities(result.vulnerabilities);
    } else {
      alert(`Vulnerability scan failed: ${result.error}`);
    }
  };

  const handleDoSAttack = async () => {
    if (!window.api || !dosTarget) return;
    setDosActive(true);
    const result = await window.api.dosAttack(dosTarget, dosPort, dosType, dosDuration);
    setTimeout(() => setDosActive(false), dosDuration * 1000);
    if (!result.success) {
      alert(`DoS attack failed: ${result.error}`);
      setDosActive(false);
    }
  };

  const handleHijackSession = async () => {
    if (!window.api || !selectedToken || !newTokenValue) return;
    const result = await window.api.hijackSession(selectedToken, newTokenValue);
    if (result.success) {
      alert('Session hijacking successful');
    } else {
      alert(`Session hijacking failed: ${result.error}`);
    }
  };

  const handleLoadExploits = async () => {
    if (!window.api) return;
    const result = await window.api.getExploitPayloads(exploitCategory);
    if (result.success && result.payloads) {
      setExploitPayloads(result.payloads);
    }
  };

  const handleDeliverPayload = async () => {
    if (!window.api || !selectedPayload || !exploitTarget) return;
    const result = await window.api.deliverPayload(exploitTarget, exploitPort, selectedPayload.payload, deliveryMethod);
    if (result.success) {
      alert('Payload delivered successfully');
    } else {
      alert(`Payload delivery failed: ${result.error}`);
    }
  };

  const handleGenerateReport = async (attackType: string, target: string) => {
    if (!window.api) return;
    const result = await window.api.generateReport(attackType, target);
    if (result.success && result.report) {
      setReports(prev => [result.report!, ...prev]);
    }
  };

  const tabs: { id: TabType; label: string; icon: React.ReactNode; color: string }[] = [
    { id: 'recon', label: 'Reconnaissance', icon: <IconRadar size={18} />, color: 'blue' },
    { id: 'packet-craft', label: 'Packet Crafting', icon: <IconBoxMultiple size={18} />, color: 'purple' },
    { id: 'mitm', label: 'MITM Attacks', icon: <IconShieldLock size={18} />, color: 'red' },
    { id: 'vuln-scan', label: 'Vuln Scanner', icon: <IconBug size={18} />, color: 'orange' },
    { id: 'dos', label: 'DoS/Stress', icon: <IconFlame size={18} />, color: 'yellow' },
    { id: 'session', label: 'Session Hijack', icon: <IconKey size={18} />, color: 'green' },
    { id: 'exploit', label: 'Exploits', icon: <IconRocket size={18} />, color: 'pink' },
    { id: 'reports', label: 'Reports', icon: <IconFileDescription size={18} />, color: 'indigo' }
  ];

  const getSeverityColor = (severity: string) => {
    switch (severity) {
      case 'critical': return 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300';
      case 'high': return 'bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-300';
      case 'medium': return 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300';
      case 'low': return 'bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300';
      default: return 'bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-300';
    }
  };

  return (
    <div className="fixed inset-0 z-50 flex items-center justify-center p-6 bg-black/40 backdrop-blur-sm">
      <div className="apple-card rounded-3xl shadow-2xl flex flex-col overflow-hidden w-full max-w-7xl max-h-[90vh]">
        {/* Header */}
        <div className="flex items-center justify-between border-b border-gray-200 px-6 py-5">
          <div className="flex items-center gap-3">
            <div className="w-10 h-10 rounded-xl bg-red-600 flex items-center justify-center">
              <IconShieldLock size={20} className="text-white" />
            </div>
            <div>
              <h2 className="text-lg font-bold text-black uppercase tracking-wide">Network Pentesting Suite</h2>
              <p className="text-xs text-black opacity-60">
                Comprehensive penetration testing and security assessment tools
              </p>
            </div>
          </div>
          <button
            onClick={onClose}
            className="apple-button rounded-xl px-4 py-2.5 text-sm font-semibold text-black"
          >
            Close
          </button>
        </div>

        {/* Warning Banner */}
        <div className="mx-6 mt-4 apple-card rounded-2xl border-2 border-red-200 bg-red-50 p-4">
          <div className="flex items-start gap-3">
            <IconAlertTriangle className="text-red-600 mt-0.5 flex-shrink-0" size={20} />
            <div className="text-sm">
              <strong className="text-red-900 font-bold">Warning:</strong>
              <span className="text-red-800"> Only use these tools on networks and systems you own or have explicit permission to test. Unauthorized access is illegal.</span>
            </div>
          </div>
        </div>

        {/* Tabs */}
        <div className="flex border-b border-gray-200 overflow-x-auto mt-4 px-6 bg-gray-50">
          {tabs.map(tab => (
            <button
              key={tab.id}
              onClick={() => setActiveTab(tab.id)}
              className={`px-5 py-3.5 text-sm font-semibold border-b-2 transition-all whitespace-nowrap ${
                activeTab === tab.id
                  ? 'border-red-600 text-red-600 bg-white'
                  : 'border-transparent text-black opacity-60 hover:opacity-100'
              }`}
            >
              {tab.label}
            </button>
          ))}
        </div>

        {/* Content */}
        <div className="flex-1 overflow-auto p-6 bg-white">
          {/* Reconnaissance Tab */}
          {activeTab === 'recon' && (
            <div className="space-y-6">
              <div className="rounded-lg border border-blue-200 bg-blue-50 dark:border-blue-900 dark:bg-blue-950/20 p-4">
                <div className="flex items-start gap-3">
                  <IconRadar className="text-blue-600 mt-0.5" size={20} />
                  <div>
                    <h3 className="font-semibold text-blue-900 dark:text-blue-300">Network Reconnaissance</h3>
                    <p className="text-sm text-blue-800 dark:text-blue-400">
                      Discover live hosts and open ports on target networks. Essential first step in penetration testing.
                    </p>
                  </div>
                </div>
              </div>

              {/* Port Scanning */}
              <div className="rounded-lg border border-neutral-200 dark:border-neutral-700 p-4">
                <h4 className="font-semibold mb-3 flex items-center gap-2">
                  <IconCpu size={18} />
                  Port Scanning
                </h4>
                <div className="space-y-3">
                  <div className="grid grid-cols-2 gap-3">
                    <div>
                      <label className="block text-sm font-medium mb-1">Target Host/IP</label>
                      <input
                        type="text"
                        value={reconTarget}
                        onChange={(e) => setReconTarget(e.target.value)}
                        placeholder="192.168.1.100 or example.com"
                        className="w-full rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-800 px-3 py-2 text-sm"
                      />
                    </div>
                    <div>
                      <label className="block text-sm font-medium mb-1">Port Range</label>
                      <input
                        type="text"
                        value={reconPorts}
                        onChange={(e) => setReconPorts(e.target.value)}
                        placeholder="80,443,8080 or 1-1000"
                        className="w-full rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-800 px-3 py-2 text-sm"
                      />
                    </div>
                  </div>

                  <div>
                    <label className="block text-sm font-medium mb-2">Scan Type</label>
                    <div className="grid grid-cols-4 gap-2">
                      {(['syn', 'connect', 'udp', 'stealth'] as const).map(type => (
                        <label key={type} className="flex items-center gap-2 px-3 py-2 border rounded-lg cursor-pointer hover:bg-neutral-50 dark:hover:bg-neutral-800">
                          <input
                            type="radio"
                            checked={scanType === type}
                            onChange={() => setScanType(type)}
                            className="rounded"
                          />
                          <span className="text-sm capitalize">{type}</span>
                        </label>
                      ))}
                    </div>
                  </div>

                  <button
                    onClick={handlePortScan}
                    disabled={scanning}
                    className="flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700 disabled:opacity-50"
                  >
                    {scanning ? <IconSearch className="animate-spin" size={16} /> : <IconPlayerPlay size={16} />}
                    {scanning ? 'Scanning...' : 'Start Port Scan'}
                  </button>

                  {portScanResults.length > 0 && (
                    <div className="rounded-lg border border-neutral-200 dark:border-neutral-700 overflow-hidden">
                      <div className="bg-neutral-100 dark:bg-neutral-800 px-3 py-2 border-b border-neutral-200 dark:border-neutral-700">
                        <h5 className="font-semibold text-sm">Scan Results ({portScanResults.length} ports)</h5>
                      </div>
                      <div className="max-h-60 overflow-auto">
                        <table className="w-full text-xs">
                          <thead className="sticky top-0 bg-neutral-100 dark:bg-neutral-800">
                            <tr>
                              <th className="px-3 py-2 text-left">Port</th>
                              <th className="px-3 py-2 text-left">State</th>
                              <th className="px-3 py-2 text-left">Service</th>
                              <th className="px-3 py-2 text-left">Version</th>
                            </tr>
                          </thead>
                          <tbody>
                            {portScanResults.map((result, idx) => (
                              <tr key={idx} className="border-b border-neutral-100 dark:border-neutral-800 hover:bg-neutral-50 dark:hover:bg-neutral-800/50">
                                <td className="px-3 py-2 font-mono font-semibold">{result.port}</td>
                                <td className="px-3 py-2">
                                  <span className={`px-2 py-1 rounded text-xs font-semibold ${
                                    result.state === 'open' ? 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300' :
                                    result.state === 'filtered' ? 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300' :
                                    'bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-300'
                                  }`}>
                                    {result.state}
                                  </span>
                                </td>
                                <td className="px-3 py-2">{result.service || '-'}</td>
                                <td className="px-3 py-2 font-mono text-xs">{result.version || '-'}</td>
                              </tr>
                            ))}
                          </tbody>
                        </table>
                      </div>
                    </div>
                  )}
                </div>
              </div>

              {/* Host Discovery */}
              <div className="rounded-lg border border-neutral-200 dark:border-neutral-700 p-4">
                <h4 className="font-semibold mb-3 flex items-center gap-2">
                  <IconSearch size={18} />
                  Host Discovery
                </h4>
                <div className="space-y-3">
                  <div className="grid grid-cols-2 gap-3">
                    <div>
                      <label className="block text-sm font-medium mb-1">Subnet</label>
                      <input
                        type="text"
                        value={hostDiscoverySubnet}
                        onChange={(e) => setHostDiscoverySubnet(e.target.value)}
                        placeholder="192.168.1.0/24"
                        className="w-full rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-800 px-3 py-2 text-sm"
                      />
                    </div>
                    <div>
                      <label className="block text-sm font-medium mb-1">Discovery Method</label>
                      <select
                        value={discoveryMethod}
                        onChange={(e) => setDiscoveryMethod(e.target.value as any)}
                        className="w-full rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-800 px-3 py-2 text-sm"
                      >
                        <option value="ping">ICMP Ping</option>
                        <option value="arp">ARP Scan</option>
                        <option value="tcp">TCP Scan</option>
                        <option value="full">Full Scan (All Methods)</option>
                      </select>
                    </div>
                  </div>

                  <button
                    onClick={handleHostDiscovery}
                    disabled={scanning}
                    className="flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700 disabled:opacity-50"
                  >
                    {scanning ? <IconSearch className="animate-spin" size={16} /> : <IconPlayerPlay size={16} />}
                    {scanning ? 'Discovering...' : 'Discover Hosts'}
                  </button>

                  {discoveredHosts.length > 0 && (
                    <div className="grid grid-cols-2 gap-3">
                      {discoveredHosts.map((host, idx) => (
                        <div key={idx} className="rounded-lg border border-neutral-200 dark:border-neutral-700 p-3 hover:border-blue-400 dark:hover:border-blue-600">
                          <div className="flex items-start justify-between mb-2">
                            <div className="font-mono font-semibold text-sm">{host.ip}</div>
                            <span className={`px-2 py-0.5 rounded text-xs font-semibold ${
                              host.status === 'up' ? 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300' :
                              'bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-300'
                            }`}>
                              {host.status}
                            </span>
                          </div>
                          {host.hostname && <div className="text-xs text-neutral-600 dark:text-neutral-400">Hostname: {host.hostname}</div>}
                          {host.mac && <div className="text-xs text-neutral-600 dark:text-neutral-400">MAC: {host.mac}</div>}
                          {host.vendor && <div className="text-xs text-neutral-600 dark:text-neutral-400">Vendor: {host.vendor}</div>}
                          {host.os && <div className="text-xs text-neutral-600 dark:text-neutral-400">OS: {host.os}</div>}
                          {host.openPorts && host.openPorts.length > 0 && (
                            <div className="text-xs text-neutral-600 dark:text-neutral-400 mt-1">
                              Open Ports: {host.openPorts.slice(0, 5).join(', ')}{host.openPorts.length > 5 && '...'}
                            </div>
                          )}
                        </div>
                      ))}
                    </div>
                  )}
                </div>
              </div>
            </div>
          )}

          {/* Packet Crafting Tab */}
          {activeTab === 'packet-craft' && (
            <div className="space-y-4">
              <div className="rounded-lg border border-purple-200 bg-purple-50 dark:border-purple-900 dark:bg-purple-950/20 p-4">
                <div className="flex items-start gap-3">
                  <IconBoxMultiple className="text-purple-600 mt-0.5" size={20} />
                  <div>
                    <h3 className="font-semibold text-purple-900 dark:text-purple-300">Custom Packet Crafting</h3>
                    <p className="text-sm text-purple-800 dark:text-purple-400">
                      Create and send custom network packets for testing, exploitation, or protocol analysis.
                    </p>
                  </div>
                </div>
              </div>

              <div className="space-y-3">
                <div>
                  <label className="block text-sm font-medium mb-2">Protocol</label>
                  <div className="grid grid-cols-6 gap-2">
                    {(['TCP', 'UDP', 'ICMP', 'ARP', 'DNS', 'HTTP'] as const).map(proto => (
                      <label key={proto} className="flex items-center gap-2 px-3 py-2 border rounded-lg cursor-pointer hover:bg-neutral-50 dark:hover:bg-neutral-800">
                        <input
                          type="radio"
                          checked={craftProtocol === proto}
                          onChange={() => setCraftProtocol(proto)}
                          className="rounded"
                        />
                        <span className="text-sm">{proto}</span>
                      </label>
                    ))}
                  </div>
                </div>

                <div className="grid grid-cols-2 gap-3">
                  <div>
                    <label className="block text-sm font-medium mb-1">Source IP</label>
                    <input
                      type="text"
                      value={craftFields.srcIP || ''}
                      onChange={(e) => setCraftFields({...craftFields, srcIP: e.target.value})}
                      placeholder="192.168.1.100"
                      className="w-full rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-800 px-3 py-2 text-sm font-mono"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-medium mb-1">Destination IP</label>
                    <input
                      type="text"
                      value={craftFields.dstIP || ''}
                      onChange={(e) => setCraftFields({...craftFields, dstIP: e.target.value})}
                      placeholder="192.168.1.1"
                      className="w-full rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-800 px-3 py-2 text-sm font-mono"
                    />
                  </div>
                </div>

                {(craftProtocol === 'TCP' || craftProtocol === 'UDP') && (
                  <div className="grid grid-cols-2 gap-3">
                    <div>
                      <label className="block text-sm font-medium mb-1">Source Port</label>
                      <input
                        type="number"
                        value={craftFields.srcPort || ''}
                        onChange={(e) => setCraftFields({...craftFields, srcPort: Number(e.target.value)})}
                        placeholder="12345"
                        className="w-full rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-800 px-3 py-2 text-sm font-mono"
                      />
                    </div>
                    <div>
                      <label className="block text-sm font-medium mb-1">Destination Port</label>
                      <input
                        type="number"
                        value={craftFields.dstPort || ''}
                        onChange={(e) => setCraftFields({...craftFields, dstPort: Number(e.target.value)})}
                        placeholder="80"
                        className="w-full rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-800 px-3 py-2 text-sm font-mono"
                      />
                    </div>
                  </div>
                )}

                <div>
                  <label className="block text-sm font-medium mb-1">Payload Data (optional)</label>
                  <textarea
                    value={craftFields.payload || ''}
                    onChange={(e) => setCraftFields({...craftFields, payload: e.target.value})}
                    placeholder="Custom payload data..."
                    rows={3}
                    className="w-full rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-800 px-3 py-2 text-sm font-mono"
                  />
                </div>

                <button
                  onClick={handleCraftPacket}
                  className="flex items-center gap-2 rounded-lg bg-purple-600 px-4 py-2 text-sm font-medium text-white hover:bg-purple-700"
                >
                  <IconBoxMultiple size={16} />
                  Craft Packet
                </button>

                {craftedPacket && (
                  <div className="space-y-3">
                    <div>
                      <label className="block text-sm font-medium mb-1">Crafted Packet (Hex)</label>
                      <textarea
                        value={craftedPacket}
                        readOnly
                        rows={4}
                        className="w-full rounded-lg border border-neutral-300 dark:border-neutral-700 bg-neutral-50 dark:bg-neutral-900 px-3 py-2 text-sm font-mono"
                      />
                    </div>

                    <div className="grid grid-cols-2 gap-3">
                      <div>
                        <label className="block text-sm font-medium mb-1">Packet Count</label>
                        <input
                          type="number"
                          value={packetCount}
                          onChange={(e) => setPacketCount(Number(e.target.value))}
                          min={1}
                          className="w-full rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-800 px-3 py-2 text-sm"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-medium mb-1">Delay (ms)</label>
                        <input
                          type="number"
                          value={packetDelay}
                          onChange={(e) => setPacketDelay(Number(e.target.value))}
                          min={0}
                          className="w-full rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-800 px-3 py-2 text-sm"
                        />
                      </div>
                    </div>

                    <button
                      onClick={handleSendCraftedPacket}
                      className="flex items-center gap-2 rounded-lg bg-green-600 px-4 py-2 text-sm font-medium text-white hover:bg-green-700"
                    >
                      <IconPlayerPlay size={16} />
                      Send Packets
                    </button>
                  </div>
                )}
              </div>
            </div>
          )}

          {/* MITM Tab */}
          {activeTab === 'mitm' && (
            <div className="space-y-4">
              <div className="rounded-lg border border-red-200 bg-red-50 dark:border-red-900 dark:bg-red-950/20 p-4">
                <div className="flex items-start gap-3">
                  <IconShieldLock className="text-red-600 mt-0.5" size={20} />
                  <div>
                    <h3 className="font-semibold text-red-900 dark:text-red-300">Man-in-the-Middle Attacks</h3>
                    <p className="text-sm text-red-800 dark:text-red-400">
                      Intercept and modify network traffic between targets. Includes ARP spoofing, DNS spoofing, and SSL stripping.
                    </p>
                  </div>
                </div>
              </div>

              <div className="space-y-3">
                <div>
                  <label className="block text-sm font-medium mb-2">Attack Type</label>
                  <div className="grid grid-cols-3 gap-2">
                    {(['arp-spoof', 'dns-spoof', 'ssl-strip'] as const).map(type => (
                      <label key={type} className="flex items-center gap-2 px-3 py-2 border rounded-lg cursor-pointer hover:bg-neutral-50 dark:hover:bg-neutral-800">
                        <input
                          type="radio"
                          checked={mitmType === type}
                          onChange={() => setMitmType(type)}
                          className="rounded"
                        />
                        <span className="text-sm">{type.toUpperCase()}</span>
                      </label>
                    ))}
                  </div>
                </div>

                <div className="grid grid-cols-2 gap-3">
                  <div>
                    <label className="block text-sm font-medium mb-1">Target IP</label>
                    <input
                      type="text"
                      value={mitmTarget}
                      onChange={(e) => setMitmTarget(e.target.value)}
                      placeholder="192.168.1.100"
                      className="w-full rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-800 px-3 py-2 text-sm"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-medium mb-1">Gateway IP</label>
                    <input
                      type="text"
                      value={mitmGateway}
                      onChange={(e) => setMitmGateway(e.target.value)}
                      placeholder="192.168.1.1"
                      className="w-full rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-800 px-3 py-2 text-sm"
                    />
                  </div>
                </div>

                <button
                  onClick={handleStartMITM}
                  className="flex items-center gap-2 rounded-lg bg-red-600 px-4 py-2 text-sm font-medium text-white hover:bg-red-700"
                >
                  <IconPlayerPlay size={16} />
                  Start MITM Attack
                </button>

                {mitmSessions.length > 0 && (
                  <div className="rounded-lg border border-neutral-200 dark:border-neutral-700 overflow-hidden">
                    <div className="bg-neutral-100 dark:bg-neutral-800 px-3 py-2 border-b border-neutral-200 dark:border-neutral-700">
                      <h5 className="font-semibold text-sm">Active MITM Sessions ({mitmSessions.length})</h5>
                    </div>
                    <div className="divide-y divide-neutral-100 dark:divide-neutral-800">
                      {mitmSessions.map((session) => (
                        <div key={session.id} className="p-3 hover:bg-neutral-50 dark:hover:bg-neutral-800/50">
                          <div className="flex items-center justify-between mb-2">
                            <div className="font-semibold text-sm">{session.type.toUpperCase()}</div>
                            <div className="flex items-center gap-2">
                              <span className={`px-2 py-1 rounded text-xs font-semibold ${
                                session.status === 'active' ? 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300' :
                                'bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-300'
                              }`}>
                                {session.status}
                              </span>
                              <button
                                onClick={() => handleStopMITM(session.id)}
                                className="rounded bg-red-600 px-2 py-1 text-xs text-white hover:bg-red-700"
                              >
                                Stop
                              </button>
                            </div>
                          </div>
                          <div className="text-xs text-neutral-600 dark:text-neutral-400 space-y-1">
                            <div>Target: {session.target} â†’ Gateway: {session.gateway}</div>
                            <div>Packets Intercepted: {session.packetsIntercepted}</div>
                            <div>Started: {session.startTime}</div>
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>
                )}
              </div>
            </div>
          )}

          {/* Vulnerability Scanner Tab */}
          {activeTab === 'vuln-scan' && (
            <div className="space-y-4">
              <div className="rounded-lg border border-orange-200 bg-orange-50 dark:border-orange-900 dark:bg-orange-950/20 p-4">
                <div className="flex items-start gap-3">
                  <IconBug className="text-orange-600 mt-0.5" size={20} />
                  <div>
                    <h3 className="font-semibold text-orange-900 dark:text-orange-300">Vulnerability Scanner</h3>
                    <p className="text-sm text-orange-800 dark:text-orange-400">
                      Automated vulnerability detection for common security weaknesses, misconfigurations, and known CVEs.
                    </p>
                  </div>
                </div>
              </div>

              <div className="space-y-3">
                <div className="grid grid-cols-2 gap-3">
                  <div>
                    <label className="block text-sm font-medium mb-1">Target Host/IP</label>
                    <input
                      type="text"
                      value={vulnTarget}
                      onChange={(e) => setVulnTarget(e.target.value)}
                      placeholder="192.168.1.100 or example.com"
                      className="w-full rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-800 px-3 py-2 text-sm"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-medium mb-1">Scan Type</label>
                    <select
                      value={vulnScanType}
                      onChange={(e) => setVulnScanType(e.target.value as any)}
                      className="w-full rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-800 px-3 py-2 text-sm"
                    >
                      <option value="quick">Quick Scan</option>
                      <option value="full">Full Scan</option>
                      <option value="web">Web Application Scan</option>
                      <option value="ssl">SSL/TLS Scan</option>
                    </select>
                  </div>
                </div>

                <button
                  onClick={handleVulnerabilityScan}
                  disabled={vulnScanning}
                  className="flex items-center gap-2 rounded-lg bg-orange-600 px-4 py-2 text-sm font-medium text-white hover:bg-orange-700 disabled:opacity-50"
                >
                  {vulnScanning ? <IconSearch className="animate-spin" size={16} /> : <IconPlayerPlay size={16} />}
                  {vulnScanning ? 'Scanning...' : 'Start Vulnerability Scan'}
                </button>

                {vulnerabilities.length > 0 && (
                  <div className="space-y-2">
                    <div className="flex items-center justify-between">
                      <h5 className="font-semibold text-sm">Vulnerabilities Found ({vulnerabilities.length})</h5>
                      <button
                        onClick={() => handleGenerateReport('vulnerability-scan', vulnTarget)}
                        className="text-xs text-blue-600 hover:text-blue-700"
                      >
                        Generate Report
                      </button>
                    </div>
                    {vulnerabilities.map((vuln) => (
                      <div key={vuln.id} className="rounded-lg border-2 border-neutral-200 dark:border-neutral-700 p-3">
                        <div className="flex items-start justify-between mb-2">
                          <div className="flex-1">
                            <div className="flex items-center gap-2 mb-1">
                              <span className={`px-2 py-1 rounded text-xs font-bold uppercase ${getSeverityColor(vuln.severity)}`}>
                                {vuln.severity}
                              </span>
                              {vuln.cve && (
                                <span className="px-2 py-1 rounded bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-300 text-xs font-mono font-semibold">
                                  {vuln.cve}
                                </span>
                              )}
                              <span className="text-xs text-neutral-500">Confidence: {vuln.confidence}%</span>
                            </div>
                            <div className="font-semibold">{vuln.vulnerability}</div>
                          </div>
                        </div>
                        <div className="text-sm text-neutral-700 dark:text-neutral-300 mb-2">{vuln.description}</div>
                        <div className="text-xs text-neutral-600 dark:text-neutral-400 mb-1">
                          <strong>Host:</strong> {vuln.host}{vuln.port && ` :${vuln.port}`}
                        </div>
                        <div className="text-xs bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-900 rounded p-2">
                          <strong className="text-blue-900 dark:text-blue-300">Remediation:</strong> {vuln.remediation}
                        </div>
                      </div>
                    ))}
                  </div>
                )}
              </div>
            </div>
          )}

          {/* DoS/Stress Testing Tab */}
          {activeTab === 'dos' && (
            <div className="space-y-4">
              <div className="rounded-lg border border-yellow-200 bg-yellow-50 dark:border-yellow-900 dark:bg-yellow-950/20 p-4">
                <div className="flex items-start gap-3">
                  <IconFlame className="text-yellow-600 mt-0.5" size={20} />
                  <div>
                    <h3 className="font-semibold text-yellow-900 dark:text-yellow-300">DoS & Stress Testing</h3>
                    <p className="text-sm text-yellow-800 dark:text-yellow-400">
                      Test network resilience with controlled denial-of-service attacks. Use responsibly for authorized testing only.
                    </p>
                  </div>
                </div>
              </div>

              <div className="space-y-3">
                <div className="grid grid-cols-2 gap-3">
                  <div>
                    <label className="block text-sm font-medium mb-1">Target IP</label>
                    <input
                      type="text"
                      value={dosTarget}
                      onChange={(e) => setDosTarget(e.target.value)}
                      placeholder="192.168.1.100"
                      className="w-full rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-800 px-3 py-2 text-sm"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-medium mb-1">Target Port</label>
                    <input
                      type="number"
                      value={dosPort}
                      onChange={(e) => setDosPort(Number(e.target.value))}
                      placeholder="80"
                      className="w-full rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-800 px-3 py-2 text-sm"
                    />
                  </div>
                </div>

                <div className="grid grid-cols-2 gap-3">
                  <div>
                    <label className="block text-sm font-medium mb-1">Attack Type</label>
                    <select
                      value={dosType}
                      onChange={(e) => setDosType(e.target.value as any)}
                      className="w-full rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-800 px-3 py-2 text-sm"
                    >
                      <option value="syn">SYN Flood</option>
                      <option value="udp">UDP Flood</option>
                      <option value="icmp">ICMP Flood</option>
                      <option value="slowloris">Slowloris</option>
                    </select>
                  </div>
                  <div>
                    <label className="block text-sm font-medium mb-1">Duration (seconds)</label>
                    <input
                      type="number"
                      value={dosDuration}
                      onChange={(e) => setDosDuration(Number(e.target.value))}
                      min={1}
                      max={60}
                      className="w-full rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-800 px-3 py-2 text-sm"
                    />
                  </div>
                </div>

                <button
                  onClick={handleDoSAttack}
                  disabled={dosActive}
                  className="flex items-center gap-2 rounded-lg bg-yellow-600 px-4 py-2 text-sm font-medium text-white hover:bg-yellow-700 disabled:opacity-50"
                >
                  {dosActive ? <IconPlayerStop size={16} /> : <IconFlame size={16} />}
                  {dosActive ? 'Attack Running...' : 'Start DoS Attack'}
                </button>

                {dosActive && (
                  <div className="rounded-lg border border-yellow-200 bg-yellow-50 dark:border-yellow-900 dark:bg-yellow-950/20 p-3">
                    <div className="flex items-center gap-2">
                      <IconFlame className="text-yellow-600 animate-pulse" size={20} />
                      <div className="text-sm font-semibold text-yellow-900 dark:text-yellow-300">
                        DoS attack in progress against {dosTarget}:{dosPort}
                      </div>
                    </div>
                  </div>
                )}
              </div>
            </div>
          )}

          {/* Session Hijacking Tab */}
          {activeTab === 'session' && (
            <div className="space-y-4">
              <div className="rounded-lg border border-green-200 bg-green-50 dark:border-green-900 dark:bg-green-950/20 p-4">
                <div className="flex items-start gap-3">
                  <IconKey className="text-green-600 mt-0.5" size={20} />
                  <div>
                    <h3 className="font-semibold text-green-900 dark:text-green-300">Session Hijacking</h3>
                    <p className="text-sm text-green-800 dark:text-green-400">
                      Extract and manipulate session tokens from captured traffic. Test authentication mechanisms.
                    </p>
                  </div>
                </div>
              </div>

              <div className="space-y-3">
                {sessionTokens.length === 0 ? (
                  <div className="text-center py-8 text-neutral-500">
                    No session tokens captured yet. Start capturing traffic to extract tokens.
                  </div>
                ) : (
                  <div className="space-y-2">
                    <h5 className="font-semibold text-sm">Captured Session Tokens ({sessionTokens.length})</h5>
                    {sessionTokens.map((token, idx) => (
                      <div
                        key={idx}
                        onClick={() => setSelectedToken(token)}
                        className={`rounded-lg border-2 p-3 cursor-pointer transition-colors ${
                          selectedToken === token
                            ? 'border-green-400 bg-green-50 dark:border-green-600 dark:bg-green-950/20'
                            : 'border-neutral-200 dark:border-neutral-700 hover:border-green-300 dark:hover:border-green-700'
                        }`}
                      >
                        <div className="flex items-center justify-between mb-2">
                          <span className="px-2 py-1 rounded bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300 text-xs font-semibold">
                            {token.type.toUpperCase()}
                          </span>
                          <span className="text-xs text-neutral-500">Packet #{token.packet}</span>
                        </div>
                        <div className="text-sm font-semibold mb-1">{token.name}</div>
                        <div className="text-xs font-mono bg-neutral-100 dark:bg-neutral-800 rounded px-2 py-1 mb-2 truncate">
                          {token.value}
                        </div>
                        {token.domain && <div className="text-xs text-neutral-600 dark:text-neutral-400">Domain: {token.domain}</div>}
                        {token.expires && <div className="text-xs text-neutral-600 dark:text-neutral-400">Expires: {token.expires}</div>}
                        <div className="flex gap-2 mt-2">
                          {token.httpOnly && <span className="text-xs px-2 py-0.5 rounded bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300">HttpOnly</span>}
                          {token.secure && <span className="text-xs px-2 py-0.5 rounded bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-300">Secure</span>}
                        </div>
                      </div>
                    ))}
                  </div>
                )}

                {selectedToken && (
                  <div className="mt-4 space-y-3">
                    <div>
                      <label className="block text-sm font-medium mb-1">New Token Value</label>
                      <input
                        type="text"
                        value={newTokenValue}
                        onChange={(e) => setNewTokenValue(e.target.value)}
                        placeholder="Enter new token value..."
                        className="w-full rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-800 px-3 py-2 text-sm font-mono"
                      />
                    </div>
                    <button
                      onClick={handleHijackSession}
                      className="flex items-center gap-2 rounded-lg bg-green-600 px-4 py-2 text-sm font-medium text-white hover:bg-green-700"
                    >
                      <IconKey size={16} />
                      Hijack Session
                    </button>
                  </div>
                )}
              </div>
            </div>
          )}

          {/* Exploit Delivery Tab */}
          {activeTab === 'exploit' && (
            <div className="space-y-4">
              <div className="rounded-lg border border-pink-200 bg-pink-50 dark:border-pink-900 dark:bg-pink-950/20 p-4">
                <div className="flex items-start gap-3">
                  <IconRocket className="text-pink-600 mt-0.5" size={20} />
                  <div>
                    <h3 className="font-semibold text-pink-900 dark:text-pink-300">Exploit Delivery System</h3>
                    <p className="text-sm text-pink-800 dark:text-pink-400">
                      Deliver exploit payloads including reverse shells, bind shells, and injection attacks.
                    </p>
                  </div>
                </div>
              </div>

              <div className="space-y-3">
                <div>
                  <label className="block text-sm font-medium mb-2">Payload Category</label>
                  <div className="grid grid-cols-5 gap-2">
                    {(['shellcode', 'reverse-shell', 'bind-shell', 'web-shell', 'injection'] as const).map(cat => (
                      <label key={cat} className="flex items-center gap-2 px-2 py-2 border rounded-lg cursor-pointer hover:bg-neutral-50 dark:hover:bg-neutral-800 text-xs">
                        <input
                          type="radio"
                          checked={exploitCategory === cat}
                          onChange={() => setExploitCategory(cat)}
                          className="rounded"
                        />
                        <span className="capitalize">{cat.replace('-', ' ')}</span>
                      </label>
                    ))}
                  </div>
                </div>

                <button
                  onClick={handleLoadExploits}
                  className="flex items-center gap-2 rounded-lg bg-pink-600 px-4 py-2 text-sm font-medium text-white hover:bg-pink-700"
                >
                  <IconRocket size={16} />
                  Load {exploitCategory} Payloads
                </button>

                {exploitPayloads.length > 0 && (
                  <div className="space-y-2">
                    <h5 className="font-semibold text-sm">Available Payloads ({exploitPayloads.length})</h5>
                    {exploitPayloads.map((payload) => (
                      <div
                        key={payload.id}
                        onClick={() => setSelectedPayload(payload)}
                        className={`rounded-lg border-2 p-3 cursor-pointer transition-colors ${
                          selectedPayload?.id === payload.id
                            ? 'border-pink-400 bg-pink-50 dark:border-pink-600 dark:bg-pink-950/20'
                            : 'border-neutral-200 dark:border-neutral-700 hover:border-pink-300 dark:hover:border-pink-700'
                        }`}
                      >
                        <div className="flex items-center justify-between mb-2">
                          <div className="font-semibold">{payload.name}</div>
                          <span className="px-2 py-1 rounded bg-pink-100 text-pink-800 dark:bg-pink-900/30 dark:text-pink-300 text-xs font-semibold">
                            {payload.platform}
                          </span>
                        </div>
                        <div className="text-sm text-neutral-700 dark:text-neutral-300">{payload.description}</div>
                      </div>
                    ))}
                  </div>
                )}

                {selectedPayload && (
                  <div className="space-y-3 mt-4">
                    <div className="grid grid-cols-3 gap-3">
                      <div>
                        <label className="block text-sm font-medium mb-1">Target Host</label>
                        <input
                          type="text"
                          value={exploitTarget}
                          onChange={(e) => setExploitTarget(e.target.value)}
                          placeholder="192.168.1.100"
                          className="w-full rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-800 px-3 py-2 text-sm"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-medium mb-1">Target Port</label>
                        <input
                          type="number"
                          value={exploitPort}
                          onChange={(e) => setExploitPort(Number(e.target.value))}
                          placeholder="4444"
                          className="w-full rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-800 px-3 py-2 text-sm"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-medium mb-1">Delivery Method</label>
                        <select
                          value={deliveryMethod}
                          onChange={(e) => setDeliveryMethod(e.target.value as any)}
                          className="w-full rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-800 px-3 py-2 text-sm"
                        >
                          <option value="tcp">TCP</option>
                          <option value="udp">UDP</option>
                          <option value="http">HTTP</option>
                        </select>
                      </div>
                    </div>

                    <button
                      onClick={handleDeliverPayload}
                      className="flex items-center gap-2 rounded-lg bg-red-600 px-4 py-2 text-sm font-medium text-white hover:bg-red-700"
                    >
                      <IconRocket size={16} />
                      Deliver Exploit
                    </button>
                  </div>
                )}
              </div>
            </div>
          )}

          {/* Reports Tab */}
          {activeTab === 'reports' && (
            <div className="space-y-4">
              <div className="rounded-lg border border-indigo-200 bg-indigo-50 dark:border-indigo-900 dark:bg-indigo-950/20 p-4">
                <div className="flex items-start gap-3">
                  <IconFileDescription className="text-indigo-600 mt-0.5" size={20} />
                  <div>
                    <h3 className="font-semibold text-indigo-900 dark:text-indigo-300">Attack Reports & Documentation</h3>
                    <p className="text-sm text-indigo-800 dark:text-indigo-400">
                      View generated reports from penetration testing activities, vulnerabilities found, and attack outcomes.
                    </p>
                  </div>
                </div>
              </div>

              {reports.length === 0 ? (
                <div className="text-center py-8 text-neutral-500">
                  No reports generated yet. Run vulnerability scans or attacks to generate reports.
                </div>
              ) : (
                <div className="space-y-3">
                  {reports.map((report) => (
                    <div key={report.id} className="rounded-lg border border-neutral-200 dark:border-neutral-700 overflow-hidden">
                      <div className="bg-neutral-100 dark:bg-neutral-800 px-4 py-3 border-b border-neutral-200 dark:border-neutral-700 flex items-center justify-between">
                        <div>
                          <div className="font-semibold">{report.attackType}</div>
                          <div className="text-xs text-neutral-600 dark:text-neutral-400">{report.timestamp}</div>
                        </div>
                        <span className={`px-3 py-1 rounded text-xs font-semibold ${
                          report.status === 'success' ? 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300' :
                          report.status === 'failed' ? 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300' :
                          'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300'
                        }`}>
                          {report.status}
                        </span>
                      </div>
                      <div className="p-4 space-y-3">
                        <div>
                          <strong className="text-sm">Target:</strong> {report.target}
                        </div>
                        {report.findings.length > 0 && (
                          <div>
                            <strong className="text-sm">Key Findings:</strong>
                            <ul className="list-disc list-inside text-sm text-neutral-700 dark:text-neutral-300 mt-1">
                              {report.findings.map((finding, idx) => (
                                <li key={idx}>{finding}</li>
                              ))}
                            </ul>
                          </div>
                        )}
                        {report.vulnerabilities.length > 0 && (
                          <div>
                            <strong className="text-sm">Vulnerabilities ({report.vulnerabilities.length}):</strong>
                            <div className="space-y-1 mt-1">
                              {report.vulnerabilities.map((vuln, idx) => (
                                <div key={idx} className="text-xs flex items-center gap-2">
                                  <span className={`px-2 py-0.5 rounded font-semibold ${getSeverityColor(vuln.severity)}`}>
                                    {vuln.severity}
                                  </span>
                                  <span>{vuln.vulnerability}</span>
                                </div>
                              ))}
                            </div>
                          </div>
                        )}
                      </div>
                    </div>
                  ))}
                </div>
              )}
            </div>
          )}
        </div>
      </div>
    </div>
  );
};

export default PentestingPanel;
